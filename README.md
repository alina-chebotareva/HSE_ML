# Отчёт по первой части проекта: прогноз цены автомобиля

## 1. Что было сделано

1. **EDA и первичный анализ данных**
   - Проанализирована структура датасета, типы признаков, наличие пропусков и дубликатов.
   - Исследованы распределения числовых и категориальных признаков.
   - Выявлены зависимости между признаками и целевой переменной `selling_price`.

2. **Предобработка данных**
   - Удалены дубликаты и столбцы (`name`, `torque`).
   - Строковые числовые признаки (`mileage`, `engine`, `max_power`) приведены к числовому виду.
   - Пропуски заполнены медианами, рассчитанными по обучающей выборке.
   - Категориальные признаки закодированы с помощью OneHot-кодирования.
   - Числовые признаки стандартизированы.

3. **Построение и сравнение моделей**
   - Обучена линейная регрессия на числовых признаках.
   - Добавлены регуляризованные модели: Ridge, Lasso, ElasticNet.
   - Подбор гиперпараметров выполнен с помощью GridSearchCV и 10-кратной кросс-валидации.
   - Модели сравнивались по метрикам R2 и MSE.

4. **Бизнес-метрика**
   - Реализована кастомная метрика: доля предсказаний, отличающихся от реальной цены не более чем на 10%.
   - Проведено сравнение моделей с точки зрения бизнес-метрики.

5. **Streamlit-приложение**
   - Реализовано интерактивное приложение для EDA, прогнозирования и анализа весов модели.
   - Поддерживается загрузка CSV и ручной ввод параметров автомобиля.


## 2. Полученные результаты

- Линейная регрессия на числовых признаках показала качество R2 = 0.59 на тестовой выборке.
- Добавление регуляризации не дало прироста качества.
- Добавление категориальных признаков дало наибольший прирост как по R2 (0,64), так и по бизнес-метрике (0,247).


## 3. Что не удалось и почему

- Существенно увеличить R2 не удалось, так как модель остаётся линейной, а зависимости в данных, вероятно, нелинейные.
- Признаки `torque` и `name`  были исключёны из-за сложности и неоднородности формата.


## 4. Оценка разработанного сервиса

### Удобство использования
- Приложение интуитивно понятно: есть отдельные вкладки для EDA, прогнозирования и анализа модели.
- Поддерживается как загрузка CSV, так и ручной ввод данных.

### Визуализации
- Реализованы визуализации распределения признаков, корреляции и взаимосвязи.
- Pairplot позволяет наглядно оценить зависимости между числовыми признаками.
- Наглядно представлены веса модели.

### Ограничения и проблемы
- Pairplot может быть тяжёлым для больших выборок.


### Планы по улучшению
- Добавить нелинейные модели.
- Сделать обработку выбросов.
- Добавить сравнение моделей прямо в интерфейсе.
